/*! cornerstone-wado-image-loader - 2.1.4 - 2018-10-18 | (c) 2016 Chris Hafey | https://github.com/cornerstonejs/cornerstoneWADOImageLoader */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("cornerstoneWADOImageLoader",[],t):"object"==typeof exports?exports.cornerstoneWADOImageLoader=t():e.cornerstoneWADOImageLoader=t()}(this,function(){return function(e){var t={};function r(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=46)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(r(53));var n=void 0,o=void 0,i={set cornerstone(e){n=e,(0,a.default)(n)},get cornerstone(){if(!n){if(!window||!window.cornerstone)throw new Error("cornerstoneWADOImageLoader requires a copy of Cornerstone to work properly. Please add cornerstoneWADOImageLoader.external.cornerstone = cornerstone; to your application.");n=window.cornerstone,(0,a.default)(n)}return n},set dicomParser(e){o=e},get dicomParser(){if(!o){if(!window||!window.dicomParser)throw new Error("cornerstoneWADOImageLoader requires a copy of dicomParser to work properly. Please add cornerstoneWADOImageLoader.external.dicomParser = dicomParser; to your application.");o=window.dicomParser}return o}};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=e[0],r=e[0],a=void 0,n=e.length,o=1;o<n;o++)a=e[o],t=Math.min(t,a),r=Math.max(r,a);return{min:t,max:r}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.internal=t.xhrRequest=t.getOptions=t.setOptions=void 0;var a=function(e){return e&&e.__esModule?e:{default:e}}(r(56)),n=r(6);var o={xhrRequest:a.default,setOptions:n.setOptions,getOptions:n.getOptions};t.setOptions=n.setOptions,t.getOptions=n.getOptions,t.xhrRequest=a.default,t.internal=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=void 0;function n(){if("undefined"==typeof CharLS)throw new Error("No JPEG-LS decoder loaded");if(!(a||(a=CharLS())&&a._jpegls_decode))throw new Error("JPEG-LS failed to initialize")}t.default=function(e,t){n();var r=function(e,t){var r=a._malloc(e.length);a.writeArrayToMemory(e,r);var n=a._malloc(4),o=a._malloc(4),i=a._malloc(4),l=a._malloc(4),u=a._malloc(4),f=a._malloc(4),d=a._malloc(4),s=a._malloc(4),c=a._malloc(4),p={result:a.ccall("jpegls_decode","number",["number","number","number","number","number","number","number","number","number","number","number"],[r,e.length,n,o,i,l,u,f,s,d,c]),width:a.getValue(i,"i32"),height:a.getValue(l,"i32"),bitsPerSample:a.getValue(u,"i32"),stride:a.getValue(f,"i32"),components:a.getValue(s,"i32"),allowedLossyError:a.getValue(d,"i32"),interleaveMode:a.getValue(c,"i32"),pixelData:void 0},m=a.getValue(n,"*");return p.bitsPerSample<=8?(p.pixelData=new Uint8Array(p.width*p.height*p.components),p.pixelData.set(new Uint8Array(a.HEAP8.buffer,m,p.pixelData.length))):t?(p.pixelData=new Int16Array(p.width*p.height*p.components),p.pixelData.set(new Int16Array(a.HEAP16.buffer,m,p.pixelData.length))):(p.pixelData=new Uint16Array(p.width*p.height*p.components),p.pixelData.set(new Uint16Array(a.HEAP16.buffer,m,p.pixelData.length))),a._free(r),a._free(m),a._free(n),a._free(o),a._free(i),a._free(l),a._free(u),a._free(f),a._free(s),a._free(c),p}(t,1===e.pixelRepresentation);if(0!==r.result&&6!==r.result)throw new Error("JPEG-LS decoder failed to decode frame (error code "+r.result+")");return e.columns=r.width,e.rows=r.height,e.pixelData=r.pixelData,e},t.initializeJPEGLS=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=void 0;function n(e,t){var r=function(e,t,r){var n=a._malloc(e.length);a.writeArrayToMemory(e,n);var o=a._malloc(4),i=a._malloc(4),l=a._malloc(4),u=a._malloc(4),f=a._malloc(4),d=(new Date).getTime();if(0!==a.ccall("jp2_decode","number",["number","number","number","number","number","number","number"],[n,e.length,o,i,l,u,f]))return console.log("[opj_decode] decoding failed!"),a._free(n),a._free(a.getValue(o,"*")),a._free(l),a._free(u),a._free(i),void a._free(f);var s=a.getValue(o,"*"),c={length:a.getValue(i,"i32"),sx:a.getValue(l,"i32"),sy:a.getValue(u,"i32"),nbChannels:a.getValue(f,"i32"),perf_timetodecode:void 0,pixelData:void 0},p=c.sx*c.sy*c.nbChannels,m=new Int32Array(a.HEAP32.buffer,s,p);if(1===t)if(Uint8Array.from)c.pixelData=Uint8Array.from(m);else{c.pixelData=new Uint8Array(p);for(var g=0;g<p;g++)c.pixelData[g]=m[g]}else if(r)if(Int16Array.from)c.pixelData=Int16Array.from(m);else{c.pixelData=new Int16Array(p);for(var v=0;v<p;v++)c.pixelData[v]=m[v]}else if(Uint16Array.from)c.pixelData=Uint16Array.from(m);else{c.pixelData=new Uint16Array(p);for(var b=0;b<p;b++)c.pixelData[b]=m[b]}var x=(new Date).getTime();return c.perf_timetodecode=x-d,a._free(n),a._free(o),a._free(s),a._free(i),a._free(l),a._free(u),a._free(f),c}(t,e.bitsAllocated<=8?1:2,1===e.pixelRepresentation);return e.columns=r.sx,e.rows=r.sy,e.pixelData=r.pixelData,r.nbChannels>1&&(e.photometricInterpretation="RGB"),e}function o(e){if(!e.usePDFJS&&"undefined"==typeof OpenJPEG)throw new Error("OpenJPEG decoder not loaded");if(!(a||(a=OpenJPEG())&&a._jp2_decode))throw new Error("OpenJPEG failed to initialize")}t.default=function(e,t,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return o(r),a.usePDFJS||r.usePDFJS?function(e,t){var r=new JpxImage;r.parse(t);var a=r.tiles.length;if(1!==a)throw new Error("JPEG2000 decoder returned a tileCount of "+a+", when 1 is expected");return e.columns=r.width,e.rows=r.height,e.pixelData=r.tiles[0].items,e}(e,t):n(e,t)},t.initializeJPEG2000=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){return t=t||0,e&&e.Value?e.Value.length<=t?r:e.Value[t]:r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setOptions=function(e){a=Object.assign(a,e)},t.getOptions=function(){return a};var a={beforeSend:function(){},imageCreated:function(){},strict:!1,useWebWorkers:!0,decodeConfig:{usePDFJS:!1}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.indexOf(":"),r=e.substring(t+1),a=r.indexOf("frame="),n=void 0;if(-1!==a){var o=r.substr(a+6);n=parseInt(o,10),r=r.substr(0,a-1)}return{scheme:e.substr(0,t),url:r,frame:n}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=[];t.default={add:function(e,t){a[e]=t},get:function(e){return a[e]},remove:function(e){a[e]=void 0},purge:function(){a=[]}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=d(r(0)),n=d(r(33)),o=d(r(34)),i=d(r(37)),l=d(r(38)),u=d(r(1)),f=d(r(39));function d(e){return e&&e.__esModule?e:{default:e}}var s="";t.default=function(e,t,r,d){if(!t||!t.length)return Promise.reject(new Error("The file does not contain image data."));var c=a.default.cornerstone,p=document.createElement("canvas"),m=(0,n.default)(e),g=(0,o.default)(m,r,t,p,d);return new Promise(function(t,a){g.then(function(a){var n=c.metaData.get("imagePlaneModule",e)||{},o=c.metaData.get("voiLutModule",e)||{},d=c.metaData.get("modalityLutModule",e)||{},m=c.metaData.get("sopCommonModule",e)||{},g=(0,i.default)(a.photometricInterpretation);if(!(0,f.default)(a,r)&&(function(e){32===e.bitsAllocated?e.pixelData=new Float32Array(e.pixelData):16===e.bitsAllocated?0===e.pixelRepresentation?e.pixelData=new Uint16Array(e.pixelData):e.pixelData=new Int16Array(e.pixelData):e.pixelData=new Uint8Array(e.pixelData)}(a),g)){p.height=a.rows,p.width=a.columns;var v=p.getContext("2d").createImageData(a.columns,a.rows);(0,l.default)(a,v),a.imageData=v,a.pixelData=v.data;var b=(0,u.default)(a.pixelData);a.smallestPixelValue=b.min,a.largestPixelValue=b.max}var x={imageId:e,color:g,columnPixelSpacing:n.columnPixelSpacing,columns:a.columns,height:a.rows,intercept:d.rescaleIntercept?d.rescaleIntercept:0,invert:"MONOCHROME1"===a.photometricInterpretation,minPixelValue:a.smallestPixelValue,maxPixelValue:a.largestPixelValue,rowPixelSpacing:n.rowPixelSpacing,rows:a.rows,sizeInBytes:a.pixelData.length,slope:d.rescaleSlope?d.rescaleSlope:1,width:a.columns,windowCenter:o.windowCenter?o.windowCenter[0]:void 0,windowWidth:o.windowWidth?o.windowWidth[0]:void 0,decodeTimeInMS:a.decodeTimeInMS,floatPixelData:void 0};if(a.pixelData instanceof Float32Array){var P=a.pixelData,y=function(e){for(var t=(0,u.default)(e),r=Math.abs(t.max-t.min)/65535,a=t.min,n=e.length,o=new Uint16Array(n),i=65535,l=0,f=0;f<n;f++){var d=Math.floor((e[f]-a)/r);o[f]=d,i=Math.min(i,d),l=Math.max(l,d)}return{min:i,max:l,intPixelData:o,slope:r,intercept:a}}(P);x.minPixelValue=y.min,x.maxPixelValue=y.max,x.slope=y.slope,x.intercept=y.intercept,x.floatPixelData=P,x.getPixelData=function(){return y.intPixelData}}else x.getPixelData=function(){return a.pixelData};if(x.color&&(x.getCanvas=function(){return s===e?p:(p.height=x.rows,p.width=x.columns,p.getContext("2d").putImageData(a.imageData,0,0),s=e,p)}),d.modalityLUTSequence&&d.modalityLUTSequence.length>0&&function(e){return"1.2.840.10008.5.1.4.1.1.12.1"!==e&&"1.2.840.10008.5.1.4.1.1.12.2.1"!==e}(m.sopClassUID)&&(x.modalityLUT=d.modalityLUTSequence[0]),o.voiLUTSequence&&o.voiLUTSequence.length>0&&(x.voiLUT=o.voiLUTSequence[0]),x.color&&(x.windowWidth=255,x.windowCenter=127),void 0===x.windowCenter||void 0===x.windowWidth){var h=x.maxPixelValue*x.slope+x.intercept,w=x.minPixelValue*x.slope+x.intercept;x.windowWidth=h-w,x.windowCenter=(h+w)/2}t(x)},a)})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=d(r(11)),n=d(r(12)),o=d(r(13)),i=d(r(14)),l=d(r(15)),u=d(r(3)),f=d(r(4));function d(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t,r,d,s){var c=(new Date).getTime();if("1.2.840.10008.1.2"===t)e=(0,a.default)(e,r);else if("1.2.840.10008.1.2.1"===t)e=(0,a.default)(e,r);else if("1.2.840.10008.1.2.2"===t)e=(0,n.default)(e,r);else if("1.2.840.10008.1.2.1.99"===t)e=(0,a.default)(e,r);else if("1.2.840.10008.1.2.5"===t)e=(0,o.default)(e,r);else if("1.2.840.10008.1.2.4.50"===t)e=(0,i.default)(e,r);else if("1.2.840.10008.1.2.4.51"===t)e=(0,i.default)(e,r);else if("1.2.840.10008.1.2.4.57"===t)e=(0,l.default)(e,r);else if("1.2.840.10008.1.2.4.70"===t)e=(0,l.default)(e,r);else if("1.2.840.10008.1.2.4.80"===t)e=(0,u.default)(e,r);else if("1.2.840.10008.1.2.4.81"===t)e=(0,u.default)(e,r);else if("1.2.840.10008.1.2.4.90"===t)e=(0,f.default)(e,r,d,s);else{if("1.2.840.10008.1.2.4.91"!==t)throw new Error("no decoder for transfer syntax "+t);e=(0,f.default)(e,r,d,s)}var p=void 0!==e.pixelRepresentation&&1===e.pixelRepresentation,m=p&&void 0!==e.bitsStored?32-e.bitsStored:void 0;if(p&&void 0!==m)for(var g=0;g<e.pixelData.length;g++)e.pixelData[g]=e.pixelData[g]<<m>>m;var v=(new Date).getTime();return e.decodeTimeInMS=v-c,e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=t.buffer,a=t.byteOffset,n=t.length;return 16===e.bitsAllocated?(a%2&&(r=r.slice(a),a=0),0===e.pixelRepresentation?e.pixelData=new Uint16Array(r,a,n/2):e.pixelData=new Int16Array(r,a,n/2)):8===e.bitsAllocated||1===e.bitsAllocated?e.pixelData=t:32===e.bitsAllocated&&(a%2&&(r=r.slice(a),a=0),e.pixelData=new Float32Array(r,a,n/4)),e}},function(e,t,r){"use strict";function a(e){return(255&e)<<8|e>>8&255}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(16===e.bitsAllocated){var r=t.buffer,n=t.byteOffset,o=t.length;n%2&&(r=r.slice(n),n=0),0===e.pixelRepresentation?e.pixelData=new Uint16Array(r,n,o/2):e.pixelData=new Int16Array(r,n,o/2);for(var i=0;i<e.pixelData.length;i++)e.pixelData[i]=a(e.pixelData[i])}else 8===e.bitsAllocated&&(e.pixelData=t);return e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(8===e.bitsAllocated)return e.planarConfiguration?function(e,t){for(var r=t,a=e.rows*e.columns,n=new ArrayBuffer(a*e.samplesPerPixel),o=new DataView(r.buffer,r.byteOffset),i=new Int8Array(r.buffer,r.byteOffset),l=new Int8Array(n),u=0,f=o.getInt32(0,!0),d=0;d<f;++d){u=d*a;var s=o.getInt32(4*(d+1),!0),c=o.getInt32(4*(d+2),!0);0===c&&(c=r.length);for(var p=a*f;s<c;){var m=i[s++];if(m>=0&&m<=127)for(var g=0;g<m+1&&u<p;++g)l[u]=i[s++],u++;else if(m<=-1&&m>=-127)for(var v=i[s++],b=0;b<1-m&&u<p;++b)l[u]=v,u++}}return e.pixelData=new Uint8Array(n),e}(e,t):function(e,t){for(var r=t,a=e.rows*e.columns,n=new ArrayBuffer(a*e.samplesPerPixel),o=new DataView(r.buffer,r.byteOffset),i=new Int8Array(r.buffer,r.byteOffset),l=new Int8Array(n),u=0,f=o.getInt32(0,!0),d=0;d<f;++d){u=d;var s=o.getInt32(4*(d+1),!0),c=o.getInt32(4*(d+2),!0);0===c&&(c=r.length);for(var p=a*f;s<c;){var m=i[s++];if(m>=0&&m<=127)for(var g=0;g<m+1&&u<p;++g)l[u]=i[s++],u+=e.samplesPerPixel;else if(m<=-1&&m>=-127)for(var v=i[s++],b=0;b<1-m&&u<p;++b)l[u]=v,u+=e.samplesPerPixel}}return e.pixelData=new Uint8Array(n),e}(e,t);if(16===e.bitsAllocated)return function(e,t){for(var r=t,a=e.rows*e.columns,n=new ArrayBuffer(a*e.samplesPerPixel*2),o=new DataView(r.buffer,r.byteOffset),i=new Int8Array(r.buffer,r.byteOffset),l=new Int8Array(n),u=o.getInt32(0,!0),f=0;f<u;++f){var d=0,s=0===f?1:0,c=o.getInt32(4*(f+1),!0),p=o.getInt32(4*(f+2),!0);for(0===p&&(p=r.length);c<p;){var m=i[c++];if(m>=0&&m<=127)for(var g=0;g<m+1&&d<a;++g)l[2*d+s]=i[c++],d++;else if(m<=-1&&m>=-127)for(var v=i[c++],b=0;b<1-m&&d<a;++b)l[2*d+s]=v,d++}}return 0===e.pixelRepresentation?e.pixelData=new Uint16Array(n):e.pixelData=new Int16Array(n),e}(e,t);throw new Error("unsupported pixel format for RLE")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("undefined"==typeof JpegImage)throw new Error("No JPEG Baseline decoder loaded");var r=new JpegImage;return r.parse(t),r.colorTransform=!1,8===e.bitsAllocated?(e.pixelData=r.getData(e.columns,e.rows),e):16===e.bitsAllocated?(e.pixelData=r.getData16(e.columns,e.rows),e):void 0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("undefined"==typeof jpeg||void 0===jpeg.lossless||void 0===jpeg.lossless.Decoder)throw new Error("No JPEG Lossless decoder loaded");var r=e.bitsAllocated<=8?1:2,a=t.buffer,n=(new jpeg.lossless.Decoder).decode(a,t.byteOffset,t.length,r);return 0===e.pixelRepresentation?16===e.bitsAllocated?(e.pixelData=new Uint16Array(n.buffer),e):(e.pixelData=new Uint8Array(n.buffer),e):(e.pixelData=new Int16Array(n.buffer),e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=(0,a.default)(e.pixelData),o=!(n(e.smallestPixelValue)&&n(e.largestPixelValue));!0!==t||o?(e.smallestPixelValue=r.min,e.largestPixelValue=r.max):(e.smallestPixelValue!==r.min&&console.warn("Image smallestPixelValue tag is incorrect. Rendering performance will suffer considerably."),e.largestPixelValue!==r.max&&console.warn("Image largestPixelValue tag is incorrect. Rendering performance will suffer considerably."))};var a=function(e){return e&&e.__esModule?e:{default:e}}(r(1));function n(e){return"number"==typeof e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getInfo=u;var a=function(e){return e&&e.__esModule?e:{default:e}}(r(0)),n=r(2);var o=0,i={},l={};function u(){return{cacheSizeInBytes:o,numberOfDataSetsCached:Object.keys(i).length}}t.default={isLoaded:function(e){return void 0!==i[e]},load:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.xhrRequest,r=arguments[2],f=a.default.cornerstone,d=a.default.dicomParser;if(i[e])return new Promise(function(t){i[e].cacheCount++,t(i[e].dataSet)});if(l[e])return l[e].cacheCount++,l[e];var s=t(e,r),c=new Promise(function(t,r){s.then(function(a){var n=new Uint8Array(a),l=void 0;try{l=d.parseDicom(n)}catch(e){return r(e)}i[e]={dataSet:l,cacheCount:c.cacheCount},o+=l.byteArray.length,t(l),f.triggerEvent(f.events,"datasetscachechanged",{uri:e,action:"loaded",cacheInfo:u()})},r).then(function(){delete l[e]},function(){delete l[e]})});return c.cacheCount=1,l[e]=c,c},unload:function(e){var t=a.default.cornerstone;i[e]&&(i[e].cacheCount--,0===i[e].cacheCount&&(o-=i[e].dataSet.byteArray.length,delete i[e],t.triggerEvent(t.events,"datasetscachechanged",{uri:e,action:"unloaded",cacheInfo:u()})))},getInfo:u,purge:function(){i={},l={}},get:function(e){if(i[e])return i[e].dataSet}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default="2.1.4"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(47);Object.defineProperty(t,"convertRGBColorByPixel",{enumerable:!0,get:function(){return u(a).default}});var n=r(48);Object.defineProperty(t,"convertRGBColorByPlane",{enumerable:!0,get:function(){return u(n).default}});var o=r(49);Object.defineProperty(t,"convertYBRFullByPixel",{enumerable:!0,get:function(){return u(o).default}});var i=r(50);Object.defineProperty(t,"convertYBRFullByPlane",{enumerable:!0,get:function(){return u(i).default}});var l=r(51);function u(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"convertPALETTECOLOR",{enumerable:!0,get:function(){return u(l).default}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(21),n=p(r(17)),o=p(r(40)),i=p(r(41)),l=p(r(42)),u=p(r(44)),f=r(45),d=p(r(7)),s=p(r(43)),c=p(r(59));function p(e){return e&&e.__esModule?e:{default:e}}var m={getImagePixelModule:a.getImagePixelModule,getLUTs:a.getLUTs,getModalityLUTOutputPixelRepresentation:a.getModalityLUTOutputPixelRepresentation,getNumberValues:a.getNumberValues,metaDataProvider:a.metaDataProvider};t.default={metaData:m,dataSetCacheManager:n.default,fileManager:o.default,getEncapsulatedImageFrame:i.default,getUncompressedImageFrame:l.default,loadFileRequest:u.default,loadImageFromPromise:f.loadImageFromPromise,getLoaderForScheme:f.getLoaderForScheme,loadImage:f.loadImage,parseImageId:d.default,unpackBinaryFrame:s.default,register:c.default}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(22);Object.defineProperty(t,"getImagePixelModule",{enumerable:!0,get:function(){return u(a).default}});var n=r(23);Object.defineProperty(t,"getLUTs",{enumerable:!0,get:function(){return u(n).default}});var o=r(24);Object.defineProperty(t,"getModalityLUTOutputPixelRepresentation",{enumerable:!0,get:function(){return u(o).default}});var i=r(25);Object.defineProperty(t,"getNumberValues",{enumerable:!0,get:function(){return u(i).default}});var l=r(52);function u(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"metaDataProvider",{enumerable:!0,get:function(){return u(l).default}})},function(e,t,r){"use strict";function a(e,t){if(e.elements[t]&&6===e.elements[t].length)return[e.uint16(t,0),e.uint16(t,1),e.uint16(t,2)]}function n(e,t,r){for(var a=[],n=e.elements[t],o=0;o<r[0];o++)16===r[2]?a[o]=e.uint16(t,o):a[o]=e.byteArray[o+n.dataOffset];return a}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={samplesPerPixel:e.uint16("x00280002"),photometricInterpretation:e.string("x00280004"),rows:e.uint16("x00280010"),columns:e.uint16("x00280011"),bitsAllocated:e.uint16("x00280100"),bitsStored:e.uint16("x00280101"),highBit:e.uint16("x00280102"),pixelRepresentation:e.uint16("x00280103"),planarConfiguration:e.uint16("x00280006"),pixelAspectRatio:e.string("x00280034")};return function(e,t){0===e.uint16("x00280103")?(t.smallestPixelValue=e.uint16("x00280106"),t.largestPixelValue=e.uint16("x00280107")):(t.smallestPixelValue=e.int16("x00280106"),t.largestPixelValue=e.int16("x00280107"))}(e,t),"PALETTE COLOR"===t.photometricInterpretation&&e.elements.x00281101&&function(e,t){t.redPaletteColorLookupTableDescriptor=a(e,"x00281101"),t.greenPaletteColorLookupTableDescriptor=a(e,"x00281102"),t.bluePaletteColorLookupTableDescriptor=a(e,"x00281103"),0===t.redPaletteColorLookupTableDescriptor[0]&&(t.redPaletteColorLookupTableDescriptor[0]=65536,t.greenPaletteColorLookupTableDescriptor[0]=65536,t.bluePaletteColorLookupTableDescriptor[0]=65536);var r=t.redPaletteColorLookupTableDescriptor[0],o=e.elements.x00281201.length===r?8:16;t.redPaletteColorLookupTableDescriptor[2]!==o&&(t.redPaletteColorLookupTableDescriptor[2]=o,t.greenPaletteColorLookupTableDescriptor[2]=o,t.bluePaletteColorLookupTableDescriptor[2]=o),t.redPaletteColorLookupTableData=n(e,"x00281201",t.redPaletteColorLookupTableDescriptor),t.greenPaletteColorLookupTableData=n(e,"x00281202",t.greenPaletteColorLookupTableDescriptor),t.bluePaletteColorLookupTableData=n(e,"x00281203",t.bluePaletteColorLookupTableDescriptor)}(e,t),t}},function(e,t,r){"use strict";function a(e,t){var r=t.uint16("x00283002",0);0===r&&(r=65535);for(var a={id:"1",firstValueMapped:0===e?t.uint16("x00283002",1):t.int16("x00283002",1),numBitsPerEntry:t.uint16("x00283002",2),lut:[]},n=0;n<r;n++)a.lut[n]=0===e?t.uint16("x00283006",n):t.int16("x00283006",n);return a}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(t&&t.items.length){for(var r=[],n=0;n<t.items.length;n++){var o=a(e,t.items[n].dataSet);o&&r.push(o)}return r}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.string("x00080016");if("1.2.840.10008.5.1.4.1.1.2"===t||"1.2.840.10008.5.1.4.1.1.2.1"===t)return 1;var r=e.floatString("x00281052"),a=e.floatString("x00281053");return void 0!==r&&void 0!==a?function(e){var t=e.uint16("x00280103"),r=e.uint16("x00280101");return 0===t?0:-1<<r-1}(e)*a+r<0?1:0:e.elements.x00283000&&e.elements.x00283000.length>0?0:e.uint16("x00280103")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){var a=[],n=e.string(t);if(n){var o=n.split("\\");if(!(r&&o.length<r)){for(var i=0;i<o.length;i++)a.push(parseFloat(o[i]));return a}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(27),n=f(r(30)),o=f(r(31)),i=f(r(8)),l=f(r(32)),u=f(r(57));function f(e){return e&&e.__esModule?e:{default:e}}var d={getNumberString:a.getNumberString,getNumberValue:a.getNumberValue,getNumberValues:a.getNumberValues,getValue:a.getValue,metaDataProvider:a.metaDataProvider};t.default={metaData:d,findIndexOfString:n.default,getPixelData:o.default,loadImage:l.default,metaDataManager:i.default,register:u.default}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(54);Object.defineProperty(t,"getNumberString",{enumerable:!0,get:function(){return u(a).default}});var n=r(28);Object.defineProperty(t,"getNumberValue",{enumerable:!0,get:function(){return u(n).default}});var o=r(29);Object.defineProperty(t,"getNumberValues",{enumerable:!0,get:function(){return u(o).default}});var i=r(5);Object.defineProperty(t,"getValue",{enumerable:!0,get:function(){return u(i).default}});var l=r(55);function u(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"metaDataProvider",{enumerable:!0,get:function(){return u(l).default}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(r(5));t.default=function(e,t){var r=(0,a.default)(e,t);if(void 0!==r)return parseFloat(r)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e&&e.Value&&!(t&&e.Value.length<t)){for(var r=[],a=0;a<e.Value.length;a++)r.push(parseFloat(e.Value[a]));return r}}},function(e,t,r){"use strict";function a(e,t,r){if(r+e.length>t.length)return!1;for(var a=r,n=0;n<e.length;n++)if(e[n]!==t[a++])return!1;return!0}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){r=r||0;for(var n=function(e){for(var t=new Uint8Array(e.length),r=0,a=e.length;r<a;r++)t[r]=e.charCodeAt(r);return t}(t),o=r;o<e.length;o++)if(n[0]===e[o]&&a(n,e,o))return o;return-1}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(2),n=function(e){return e&&e.__esModule?e:{default:e}}(r(30));t.default=function(e,t){var r={accept:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"application/octet-stream"};return new Promise(function(o,i){(0,a.xhrRequest)(e,t,r).then(function(e){var t=new Uint8Array(e),r=(0,n.default)(t,"\r\n\r\n");-1===r&&i(new Error("invalid response - no multipart mime header"));var a=function(e,t,r){t=t||0,r=r||e.length-t;for(var a="",n=t;n<t+r;n++)a+=String.fromCharCode(e[n]);return a}(t,0,r).split("\r\n"),l=function(e){for(var t=0;t<e.length;t++)if("--"===e[t].substr(0,2))return e[t]}(a);l||i(new Error("invalid response - no boundary marker"));var u=r+4,f=(0,n.default)(t,l,u);-1===f&&i(new Error("invalid response - terminating boundary not found"));var d=f-u-2;o({contentType:function(e){for(var t=0;t<e.length;t++)if("Content-Type:"===e[t].substr(0,13))return e[t].substr(13).trim()}(a),imageFrame:{pixelData:new Uint8Array(e,u,d)}})})})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTransferSyntaxForContentType=l;var a=i(r(8)),n=i(r(31)),o=i(r(9));function i(e){return e&&e.__esModule?e:{default:e}}function l(e){var t="1.2.840.10008.1.2";e&&e.split(";").forEach(function(e){var r=e.split("=");2===r.length&&"transfer-syntax"===r[0].trim()&&(t=r[1].trim()||t)});return t}t.default=function(e,t){var r=(new Date).getTime(),i=e.substring(7);return{promise:new Promise(function(u,f){if(void 0===a.default.get(e)){var d=new Error("no metadata for imageId "+e);return f(d)}(0,n.default)(i,e,'multipart/related; type="application/octet-stream"').then(function(a){var n=l(a.contentType),i=a.imageFrame.pixelData;(0,o.default)(e,i,n,t).then(function(e){var t=(new Date).getTime();e.loadTimeInMS=t-r,u(e)},f)},f)}),cancelFn:void 0}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(r(0));t.default=function(e){var t=a.default.cornerstone.metaData.get("imagePixelModule",e);return{samplesPerPixel:t.samplesPerPixel,photometricInterpretation:t.photometricInterpretation,planarConfiguration:t.planarConfiguration,rows:t.rows,columns:t.columns,bitsAllocated:t.bitsAllocated,bitsStored:t.bitsStored,pixelRepresentation:t.pixelRepresentation,smallestPixelValue:t.smallestPixelValue,largestPixelValue:t.largestPixelValue,redPaletteColorLookupTableDescriptor:t.redPaletteColorLookupTableDescriptor,greenPaletteColorLookupTableDescriptor:t.greenPaletteColorLookupTableDescriptor,bluePaletteColorLookupTableDescriptor:t.bluePaletteColorLookupTableDescriptor,redPaletteColorLookupTableData:t.redPaletteColorLookupTableData,greenPaletteColorLookupTableData:t.greenPaletteColorLookupTableData,bluePaletteColorLookupTableData:t.bluePaletteColorLookupTableData,pixelData:void 0}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(6),n=d(r(35)),o=d(r(36)),i=d(r(10)),l=d(r(16)),u=r(4),f=r(3);function d(e){return e&&e.__esModule?e:{default:e}}var s=!1;function c(e,t,r,o){var d=o.priority||void 0,c=o.transferPixelData?[r.buffer]:void 0,p=(0,a.getOptions)(),m=p.strict,g=p.decodeConfig;return!1===p.useWebWorkers?(!1===s&&((0,u.initializeJPEG2000)(g),(0,f.initializeJPEGLS)(g),s=!0),new Promise(function(a,n){try{var u=[e,t,r,g,o],f=i.default.apply(void 0,u);(0,l.default)(f,m),a(f)}catch(e){n(e)}})):n.default.addTask("decodeTask",{imageFrame:e,transferSyntax:t,pixelData:r,options:o},d,c).promise}t.default=function(e,t,r,a){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return"1.2.840.10008.1.2"===t?c(e,t,r,n):"1.2.840.10008.1.2.1"===t?c(e,t,r,n):"1.2.840.10008.1.2.2"===t?c(e,t,r,n):"1.2.840.10008.1.2.1.99"===t?c(e,t,r,n):"1.2.840.10008.1.2.5"===t?c(e,t,r,n):"1.2.840.10008.1.2.4.50"===t?8!==e.bitsAllocated||3!==e.samplesPerPixel&&4!==e.samplesPerPixel?c(e,t,r,n):(0,o.default)(e,r,a):"1.2.840.10008.1.2.4.51"===t?c(e,t,r,n):"1.2.840.10008.1.2.4.57"===t?c(e,t,r,n):"1.2.840.10008.1.2.4.70"===t?c(e,t,r,n):"1.2.840.10008.1.2.4.80"===t?c(e,t,r,n):"1.2.840.10008.1.2.4.81"===t?c(e,t,r,n):"1.2.840.10008.1.2.4.90"===t?c(e,t,r,n):"1.2.840.10008.1.2.4.91"===t?c(e,t,r,n):new Promise(function(e,r){r(new Error("No decoder for transfer syntax "+t))})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=0,n=[],o=[],i=(0,r(6).getOptions)(),l={maxWebWorkers:navigator.hardwareConcurrency||1,startWebWorkersOnDemand:!0,webWorkerPath:"../../dist/cornerstoneWADOImageLoaderWebWorker.js",webWorkerTaskPaths:[],taskConfiguration:{decodeTask:{loadCodecsOnStartup:!0,initializeCodecsOnStartup:!1,codecsPath:"../dist/cornerstoneWADOImageLoaderCodecs.js",usePDFJS:!1,strict:i.strict}}},u=void 0,f={maxWebWorkers:0,numWebWorkers:0,numTasksQueued:0,numTasksExecuting:0,numTasksCompleted:0,totalTaskTimeInMS:0,totalTimeDelayedInMS:0};function d(){if(n.length){for(var e=0;e<o.length;e++)if("ready"===o[e].status){o[e].status="busy";var t=n.shift();t.start=(new Date).getTime();var r=(new Date).getTime();return f.totalTimeDelayedInMS+=r-t.added,o[e].task=t,o[e].worker.postMessage({taskType:t.taskType,workerIndex:e,data:t.data},t.transferList),void f.numTasksExecuting++}o.length<u.maxWebWorkers&&c()}}function s(e){if("initialize"===e.data.taskType)o[e.data.workerIndex].status="ready",d();else{var t=o[e.data.workerIndex].task.start;o[e.data.workerIndex].task.deferred.resolve(e.data.result),o[e.data.workerIndex].task=void 0,f.numTasksExecuting--,o[e.data.workerIndex].status="ready",f.numTasksCompleted++;var r=(new Date).getTime();f.totalTaskTimeInMS+=r-t,d()}}function c(){if(!(o.length>=u.maxWebWorkers)){var e=new Worker(u.webWorkerPath);o.push({worker:e,status:"initializing"}),e.addEventListener("message",s),e.postMessage({taskType:"initialize",workerIndex:o.length-1,config:u})}}function p(e){if(e=e||l,u)throw new Error("WebWorkerManager already initialized");if((u=e).maxWebWorkers=u.maxWebWorkers||navigator.hardwareConcurrency||1,!u.startWebWorkersOnDemand)for(var t=0;t<u.maxWebWorkers;t++)c()}t.default={initialize:p,loadWebWorkerTask:function(e,t){u.webWorkerTaskPaths.push(e),t&&(u.taskConfiguration=Object.assign(u.taskConfiguration,t));for(var r=0;r<o.length;r++)o[r].worker.postMessage({taskType:"loadWebWorkerTask",workerIndex:o.length-1,sourcePath:e,config:u})},addTask:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments[3];u||p();var i={},l=new Promise(function(e,t){i={resolve:e,reject:t}}),f=void 0;for(f=0;f<n.length&&!(n[f].priority<r);f++);var s=a++;return n.splice(f,0,{taskId:s,taskType:e,status:"ready",added:(new Date).getTime(),data:t,deferred:i,priority:r,transferList:o}),d(),{taskId:s,promise:l}},getStatistics:function(){return f.maxWebWorkers=u.maxWebWorkers,f.numWebWorkers=o.length,f.numTasksQueued=n.length,f},setTaskPriority:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=0;r<n.length;r++)if(n[r].taskId===e){var a=n.splice(r,1)[0];for(a.priority=t,r=0;r<n.length&&!(n[r].priority<t);r++);return n.splice(r,0,a),!0}return!1},cancelTask:function(e,t){for(var r=0;r<n.length;r++)if(n[r].taskId===e)return n.splice(r,1).deferred.reject(t),!0;return!1}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(r(1));function n(e){return function(e){var t=void 0;try{return decodeURIComponent(escape(e))}catch(r){if((t=r)instanceof URIError)return e;throw t}}(String.fromCharCode.apply(null,Array.prototype.slice.apply(new Uint8Array(e))))}t.default=function(e,t,r){var o=(new Date).getTime(),i=new Blob([t],{type:"image/jpeg"});return new Promise(function(t,l){var u=new FileReader;void 0===u.readAsBinaryString?u.readAsArrayBuffer(i):u.readAsBinaryString(i),u.onload=function(){var i=new Image;i.onload=function(){r.height=i.height,r.width=i.width,e.rows=i.height,e.columns=i.width;var n=r.getContext("2d");n.drawImage(this,0,0);var l=n.getImageData(0,0,i.width,i.height),u=(new Date).getTime();e.pixelData=l.data,e.imageData=l,e.decodeTimeInMS=u-o;var f=(0,a.default)(e.pixelData);e.smallestPixelValue=f.min,e.largestPixelValue=f.max,t(e)},i.onerror=function(e){l(e)},void 0===u.readAsBinaryString?i.src="data:image/jpeg;base64,"+window.btoa(n(u.result)):i.src="data:image/jpeg;base64,"+window.btoa(u.result)},u.onerror=function(e){l(e)}})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return"RGB"===e||"PALETTE COLOR"===e||"YBR_FULL"===e||"YBR_FULL_422"===e||"YBR_PARTIAL_422"===e||"YBR_PARTIAL_420"===e||"YBR_RCT"===e||"YBR_ICT"===e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=t.data;if("RGB"===e.photometricInterpretation)n(e,r);else if("YBR_RCT"===e.photometricInterpretation)n(e,r);else if("YBR_ICT"===e.photometricInterpretation)n(e,r);else if("PALETTE COLOR"===e.photometricInterpretation)(0,a.convertPALETTECOLOR)(e,r);else if("YBR_FULL_422"===e.photometricInterpretation)n(e,r);else{if("YBR_FULL"!==e.photometricInterpretation)throw new Error("No color space conversion for photometric interpretation "+e.photometricInterpretation);!function(e,t){0===e.planarConfiguration?(0,a.convertYBRFullByPixel)(e.pixelData,t):(0,a.convertYBRFullByPlane)(e.pixelData,t)}(e,r)}};var a=r(19);function n(e,t){0===e.planarConfiguration?(0,a.convertRGBColorByPixel)(e.pixelData,t):(0,a.convertRGBColorByPlane)(e.pixelData,t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(t=t||e.transferSyntax,8===e.bitsAllocated&&"1.2.840.10008.1.2.4.50"===t&&(3===e.samplesPerPixel||4===e.samplesPerPixel))return!0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=[];t.default={add:function(e){return"dicomfile:"+(a.push(e)-1)},get:function(e){return a[e]},remove:function(e){a[e]=void 0},purge:function(){a=[]}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r=a.default.dicomParser;if(e.elements.x7fe00010&&e.elements.x7fe00010.basicOffsetTable.length)return r.readEncapsulatedImageFrame(e,e.elements.x7fe00010,t);if(function(e){var t=e.intString("x00280008"),r=e.elements.x7fe00010;return t!==r.fragments.length}(e)){var n=r.createJPEGBasicOffsetTable(e,e.elements.x7fe00010);return r.readEncapsulatedImageFrame(e,e.elements.x7fe00010,t,n)}return r.readEncapsulatedPixelDataFromFragments(e,e.elements.x7fe00010,t)};var a=function(e){return e&&e.__esModule?e:{default:e}}(r(0))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(r(43));t.default=function(e,t){var r=e.elements.x7fe00010||e.elements.x7fe00008,n=e.uint16("x00280100"),o=e.uint16("x00280010"),i=e.uint16("x00280011"),l=e.uint16("x00280002"),u=r.dataOffset,f=o*i*l,d=void 0;if(8===n){if((d=u+t*f)>=e.byteArray.length)throw new Error("frame exceeds size of pixelData");return new Uint8Array(e.byteArray.buffer,d,f)}if(16===n){if((d=u+t*f*2)>=e.byteArray.length)throw new Error("frame exceeds size of pixelData");return new Uint8Array(e.byteArray.buffer,d,2*f)}if(1===n){if((d=u+t*f*.125)>=e.byteArray.length)throw new Error("frame exceeds size of pixelData");return(0,a.default)(e.byteArray,d,f)}if(32===n){if((d=u+t*f*4)>=e.byteArray.length)throw new Error("frame exceeds size of pixelData");return new Uint8Array(e.byteArray.buffer,d,4*f)}throw new Error("unsupported pixel format")}},function(e,t,r){"use strict";function a(e,t){return e&1<<t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){for(var n=new Uint8Array(r),o=0;o<r;o++){var i=e[Math.floor(o/8)+t],l=o%8;n[o]=a(i,l)?1:0}return n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(r(7)),n=o(r(40));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=(0,a.default)(e),r=parseInt(t.url,10),o=n.default.get(r);return new Promise(function(e,t){var r=new FileReader;r.onload=function(t){var r=t.target.result;e(r)},r.onerror=t,r.readAsArrayBuffer(o)})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadImage=t.getLoaderForScheme=t.loadImageFromPromise=void 0;var a=f(r(9)),n=f(r(7)),o=f(r(17)),i=f(r(44)),l=f(r(58)),u=r(2);function f(e){return e&&e.__esModule?e:{default:e}}function d(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments[3],u=arguments[4],f=arguments[5],d=(new Date).getTime(),s={cancelFn:void 0};return s.promise=new Promise(function(c,p){e.then(function(e){var m=(0,l.default)(e,r),g=e.string("x00020010"),v=(new Date).getTime(),b=(0,a.default)(t,m,g,u);!function(e,t){e.decache=function(){var e=(0,n.default)(t);o.default.unload(e.url)}}(s,t),b.then(function(t){t.data=e,t.sharedCacheKey=i;var r=(new Date).getTime();t.loadTimeInMS=v-d,t.totalTimeInMS=r-d,void 0!==f&&void 0!==f.imageDoneCallback&&f.imageDoneCallback(t),c(t)},function(t){p({error:t,dataSet:e})})},function(e){p({error:e})})}),s}function s(e){return"dicomweb"===e||"wadouri"===e?u.xhrRequest:"dicomfile"===e?i.default:void 0}t.loadImageFromPromise=d,t.getLoaderForScheme=s,t.loadImage=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,n.default)(e),i=(t=Object.assign({},t)).loader;return void 0===i?i=s(r.scheme):delete t.loader,o.default.isLoaded(r.url)?function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments[3],o=arguments[4],i=(new Date).getTime();return{promise:new Promise(function(u,f){var d=(new Date).getTime(),s=void 0;try{var c=(0,l.default)(e,r),p=e.string("x00020010");s=(0,a.default)(t,c,p,o)}catch(t){return void f({error:t,dataSet:e})}s.then(function(t){t.data=e,t.sharedCacheKey=n;var r=(new Date).getTime();t.loadTimeInMS=d-i,t.totalTimeInMS=r-i,u(t)},f)}),cancelFn:void 0}}(o.default.get(r.url,i,e),e,r.frame,r.url,t):d(o.default.load(r.url,i,e),e,r.frame,r.url,t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(19);Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})});var n=r(20);Object.defineProperty(t,"wadouri",{enumerable:!0,get:function(){return P(n).default}});var o=r(26);Object.defineProperty(t,"wadors",{enumerable:!0,get:function(){return P(o).default}});var i=r(60);Object.defineProperty(t,"configure",{enumerable:!0,get:function(){return P(i).default}});var l=r(38);Object.defineProperty(t,"convertColorSpace",{enumerable:!0,get:function(){return P(l).default}});var u=r(9);Object.defineProperty(t,"createImage",{enumerable:!0,get:function(){return P(u).default}});var f=r(34);Object.defineProperty(t,"decodeImageFrame",{enumerable:!0,get:function(){return P(f).default}});var d=r(36);Object.defineProperty(t,"decodeJPEGBaseline8BitColor",{enumerable:!0,get:function(){return P(d).default}});var s=r(33);Object.defineProperty(t,"getImageFrame",{enumerable:!0,get:function(){return P(s).default}});var c=r(1);Object.defineProperty(t,"getMinMax",{enumerable:!0,get:function(){return P(c).default}});var p=r(37);Object.defineProperty(t,"isColorImage",{enumerable:!0,get:function(){return P(p).default}});var m=r(39);Object.defineProperty(t,"isJPEGBaseline8BitColor",{enumerable:!0,get:function(){return P(m).default}});var g=r(35);Object.defineProperty(t,"webWorkerManager",{enumerable:!0,get:function(){return P(g).default}});var v=r(18);Object.defineProperty(t,"version",{enumerable:!0,get:function(){return P(v).default}});var b=r(2);Object.defineProperty(t,"internal",{enumerable:!0,get:function(){return b.internal}});var x=r(0);function P(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"external",{enumerable:!0,get:function(){return P(x).default}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(void 0===e)throw new Error("decodeRGB: rgbBuffer must not be undefined");if(e.length%3!=0)throw new Error("decodeRGB: rgbBuffer length must be divisible by 3");for(var r=e.length/3,a=0,n=0,o=0;o<r;o++)t[n++]=e[a++],t[n++]=e[a++],t[n++]=e[a++],t[n++]=255}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(void 0===e)throw new Error("decodeRGB: rgbBuffer must not be undefined");if(e.length%3!=0)throw new Error("decodeRGB: rgbBuffer length must be divisible by 3");for(var r=e.length/3,a=0,n=0,o=r,i=2*r,l=0;l<r;l++)t[a++]=e[n++],t[a++]=e[o++],t[a++]=e[i++],t[a++]=255}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(void 0===e)throw new Error("decodeRGB: ybrBuffer must not be undefined");if(e.length%3!=0)throw new Error("decodeRGB: ybrBuffer length must be divisble by 3");for(var r=e.length/3,a=0,n=0,o=0;o<r;o++){var i=e[a++],l=e[a++],u=e[a++];t[n++]=i+1.402*(u-128),t[n++]=i-.34414*(l-128)-.71414*(u-128),t[n++]=i+1.772*(l-128),t[n++]=255}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(void 0===e)throw new Error("decodeRGB: ybrBuffer must not be undefined");if(e.length%3!=0)throw new Error("decodeRGB: ybrBuffer length must be divisble by 3");for(var r=e.length/3,a=0,n=0,o=r,i=2*r,l=0;l<r;l++){var u=e[n++],f=e[o++],d=e[i++];t[a++]=u+1.402*(d-128),t[a++]=u-.34414*(f-128)-.71414*(d-128),t[a++]=u+1.772*(f-128),t[a++]=255}}},function(e,t,r){"use strict";function a(e,t){for(var r=e.length,a=new Uint8ClampedArray(r),n=0;n<r;++n)a[n]=e[n]>>t;return a}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){for(var r=e.columns*e.rows,n=e.pixelData,o=e.redPaletteColorLookupTableData,i=e.greenPaletteColorLookupTableData,l=e.bluePaletteColorLookupTableData,u=e.redPaletteColorLookupTableData.length,f=0,d=0,s=e.redPaletteColorLookupTableDescriptor[1],c=8===e.redPaletteColorLookupTableDescriptor[2]?0:8,p=a(o,c),m=a(i,c),g=a(l,c),v=0;v<r;++v){var b=n[f++];b<s?b=0:b>s+u-1?b=u-1:b-=s,t[d++]=p[b],t[d++]=m[b],t[d++]=g[b],t[d++]=255}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=d(r(0)),n=d(r(25)),o=d(r(7)),i=d(r(17)),l=d(r(22)),u=d(r(23)),f=d(r(24));function d(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){var r=a.default.dicomParser,d=(0,o.default)(t),s=i.default.get(d.url);if(s){if("generalSeriesModule"===e)return{modality:s.string("x00080060"),seriesInstanceUID:s.string("x0020000e"),seriesNumber:s.intString("x00200011"),studyInstanceUID:s.string("x0020000d"),seriesDate:r.parseDA(s.string("x00080021")),seriesTime:r.parseTM(s.string("x00080031")||"")};if("patientStudyModule"===e)return{patientAge:s.intString("x00101010"),patientSize:s.floatString("x00101020"),patientWeight:s.floatString("x00101030")};if("imagePlaneModule"===e){var c=(0,n.default)(s,"x00200037",6),p=(0,n.default)(s,"x00200032",3),m=(0,n.default)(s,"x00280030",2),g=null,v=null;m&&(v=m[0],g=m[1]);var b=null,x=null;return c&&(b=[parseFloat(c[0]),parseFloat(c[1]),parseFloat(c[2])],x=[parseFloat(c[3]),parseFloat(c[4]),parseFloat(c[5])]),{frameOfReferenceUID:s.string("x00200052"),rows:s.uint16("x00280010"),columns:s.uint16("x00280011"),imageOrientationPatient:c,rowCosines:b,columnCosines:x,imagePositionPatient:p,sliceThickness:s.floatString("x00180050"),sliceLocation:s.floatString("x00201041"),pixelSpacing:m,rowPixelSpacing:v,columnPixelSpacing:g}}if("imagePixelModule"===e)return(0,l.default)(s);if("modalityLutModule"===e)return{rescaleIntercept:s.floatString("x00281052"),rescaleSlope:s.floatString("x00281053"),rescaleType:s.string("x00281054"),modalityLUTSequence:(0,u.default)(s.uint16("x00280103"),s.elements.x00283000)};if("voiLutModule"===e){var P=(0,f.default)(s);return{windowCenter:(0,n.default)(s,"x00281050",1),windowWidth:(0,n.default)(s,"x00281051",1),voiLUTSequence:(0,u.default)(P,s.elements.x00283010)}}if("sopCommonModule"===e)return{sopClassUID:s.string("x00080016"),sopInstanceUID:s.string("x00080018")};if("petIsotopeModule"===e){var y=s.elements.x00540016;if(void 0===y)return;var h=y.items[0].dataSet;return{radiopharmaceuticalInfo:{radiopharmaceuticalStartTime:r.parseTM(h.string("x00181072")||""),radionuclideTotalDose:h.floatString("x00181074"),radionuclideHalfLife:h.floatString("x00181075")}}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(r(26)),n=o(r(20));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){a.default.register(e),n.default.register(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(r(5));t.default=function(e,t,r){var n=(0,a.default)(e,t,r);if(void 0!==n)return parseFloat(n)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=u(r(0)),n=u(r(29)),o=u(r(5)),i=u(r(28)),l=u(r(8));function u(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){var r=a.default.dicomParser,u=l.default.get(t);if(u){if("generalSeriesModule"===e)return{modality:(0,o.default)(u["00080060"]),seriesInstanceUID:(0,o.default)(u["0020000e"]),seriesNumber:(0,i.default)(u["00200011"]),studyInstanceUID:(0,o.default)(u["0020000d"]),seriesDate:r.parseDA((0,o.default)(u["00080021"])),seriesTime:r.parseTM((0,o.default)(u["00080031"],0,""))};if("patientStudyModule"===e)return{patientAge:(0,i.default)(u["00101010"]),patientSize:(0,i.default)(u["00101020"]),patientWeight:(0,i.default)(u["00101030"])};if("imagePlaneModule"===e){var f=(0,n.default)(u["00200037"],6),d=(0,n.default)(u["00200032"],3),s=(0,n.default)(u["00280030"],2),c=null,p=null;s&&(p=s[0],c=s[1]);var m=null,g=null;return f&&(m=[parseFloat(f[0]),parseFloat(f[1]),parseFloat(f[2])],g=[parseFloat(f[3]),parseFloat(f[4]),parseFloat(f[5])]),{frameOfReferenceUID:(0,o.default)(u["00200052"]),rows:(0,i.default)(u["00280010"]),columns:(0,i.default)(u["00280011"]),imageOrientationPatient:f,rowCosines:m,columnCosines:g,imagePositionPatient:d,sliceThickness:(0,i.default)(u["00180050"]),sliceLocation:(0,i.default)(u["00201041"]),pixelSpacing:s,rowPixelSpacing:p,columnPixelSpacing:c}}if("imagePixelModule"===e)return{samplesPerPixel:(0,i.default)(u["00280002"]),photometricInterpretation:(0,o.default)(u["00280004"]),rows:(0,i.default)(u["00280010"]),columns:(0,i.default)(u["00280011"]),bitsAllocated:(0,i.default)(u["00280100"]),bitsStored:(0,i.default)(u["00280101"]),highBit:(0,o.default)(u["00280102"]),pixelRepresentation:(0,i.default)(u["00280103"]),planarConfiguration:(0,i.default)(u["00280006"]),pixelAspectRatio:(0,o.default)(u["00280034"]),smallestPixelValue:(0,i.default)(u["00280106"]),largestPixelValue:(0,i.default)(u["00280107"]),redPaletteColorLookupTableDescriptor:(0,n.default)(u["00281101"]),greenPaletteColorLookupTableDescriptor:(0,n.default)(u["00281102"]),bluePaletteColorLookupTableDescriptor:(0,n.default)(u["00281103"]),redPaletteColorLookupTableData:(0,n.default)(u["00281201"]),greenPaletteColorLookupTableData:(0,n.default)(u["00281202"]),bluePaletteColorLookupTableData:(0,n.default)(u["00281203"])};if("voiLutModule"===e)return{windowCenter:(0,n.default)(u["00281050"],1),windowWidth:(0,n.default)(u["00281051"],1)};if("modalityLutModule"===e)return{rescaleIntercept:(0,i.default)(u["00281052"]),rescaleSlope:(0,i.default)(u["00281053"]),rescaleType:(0,o.default)(u["00281054"])};if("sopCommonModule"===e)return{sopClassUID:(0,o.default)(u["00080016"]),sopInstanceUID:(0,o.default)(u["00080018"])};if("petIsotopeModule"===e){var v=(0,o.default)(u["00540016"]);if(void 0===v)return;return{radiopharmaceuticalInfo:{radiopharmaceuticalStartTime:r.parseTM((0,o.default)(v["00181072"],0,"")),radionuclideTotalDose:(0,i.default)(v["00181074"]),radionuclideHalfLife:(0,i.default)(v["00181075"])}}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(r(0)),n=r(6);t.default=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=a.default.cornerstone,l=(0,n.getOptions)();return new Promise(function(a,n){var u=new XMLHttpRequest;u.open("get",e,!0),u.responseType="arraybuffer",l.beforeSend(u,t),Object.keys(r).forEach(function(e){u.setRequestHeader(e,r[e])}),o.deferred={resolve:a,reject:n},o.url=e,o.imageId=t,u.onloadstart=function(r){l.onloadstart&&l.onloadstart(r,o);var a={url:e,imageId:t};i.triggerEvent(i.events,"cornerstoneimageloadstart",a)},u.onloadend=function(r){l.onloadend&&l.onloadend(r,o);var a={url:e,imageId:t};i.triggerEvent(i.events,"cornerstoneimageloadend",a)},u.onreadystatechange=function(e){l.onreadystatechange?l.onreadystatechange(e,o):4===u.readyState&&(200===u.status?a(u.response,u):n(u))},u.onprogress=function(r){var a=r.loaded,n=void 0,u=void 0;r.lengthComputable&&(n=r.total,u=Math.round(a/n*100)),l.onprogress&&l.onprogress(r,o);var f={url:e,imageId:t,loaded:a,total:n,percentComplete:u};i.triggerEvent(i.events,"cornerstoneimageloadprogress",f)},u.send()})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.registerImageLoader("wadors",a.default),e.metaData.addProvider(n.metaDataProvider)};var a=function(e){return e&&e.__esModule?e:{default:e}}(r(32)),n=r(27)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(r(41)),n=o(r(42));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=e.elements.x7fe00010||e.elements.x7fe00008;return r?r.encapsulatedPixelData?(0,a.default)(e,t):(0,n.default)(e,t):null}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.registerImageLoader("dicomweb",a.loadImage),e.registerImageLoader("wadouri",a.loadImage),e.registerImageLoader("dicomfile",a.loadImage),e.metaData.addProvider(n.metaDataProvider)};var a=r(45),n=r(21)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(2);t.default=function(e){(0,a.setOptions)(e)}}])});
//# sourceMappingURL=cornerstoneWADOImageLoader.min.js.map